# 第一周
## Data processing for mass spectrometry-based metabolomics
### 基于代谢组学的质谱数据处理

时间 | 期刊 | 作者 | 机构
-|-|-|-
2007 |Journal of Chromatography A|M Katajamaa & M Oresic | |

**key:Metabolomics; MassMass; Spectrometry;Chromatography; Liquids; LC-MS; Metabolite; Identification; Quantification; Metabolites**

[文献地址](http://xueshu.baidu.com/s?wd=paperuri%3A%28bc76c4208bc32d39d026c9e02fef3732%29&filter=sc_long_sign&tn=SE_xueshusource_2kduw22v&sc_vurl=http%3A%2F%2Fwww.sciencedirect.com%2Fscience%2Farticle%2Fpii%2FS0021967307006966&ie=utf-8&sc_us=8005351090699222897)

在本文中，概述了代谢组学数据处理的关键步骤，重点回顾了与本主题相关的最新文献，特别是关于液相色谱质谱（LC-MS）实验数据处理的方法

使用各种仪器得到数据之后重点在于对化合物的鉴定和定量，我们主要感兴趣的是生物系统反应导致与遗传变异或多种环境变化相关的代谢物水平调节，重要的是将感兴趣的生物变异与代谢物研究中引入的变异来源（包括数据处理的各个阶段）分开。 因此，数据处理的质量是我们正确分析和解释代谢组学数据的能力的重要步骤。

### Data processing

#### filter

这一步的操作主要用来去掉noise和baseline
1.Centroding 将具有相同峰值的数据点合并*参考一下MZmine是怎么做这一步的？*将所有m/z值分箱至固定的m/z值
2.将所有直方图转化为一个矩阵：行为m/z，列是rt，value是intensity*可以画个图出来看一下，也许可以用到下边两部？，求每行每列的相关性* 
![avatar](https://ars.els-cdn.com/content/image/1-s2.0-S0021967307006966-gr2.jpg)
3.降噪：移动平均窗口、中值滤波器、S-G滤波器、m/z方向的小波变换
4.关于基线校正：化学噪声，[19]，引起mass range的偏倚，处理基线校正分为两步：1、寻找基线形状(方法很多，[25,23,26,27]) 2、从原始信号中减去基线
#### feature detection 特征检测

挑选出来所有由真正的离子所引起的信号。做这一步大致有3种方法： 

1.从m/z和rt两个方向独立发现peak，沿着一个向量使用所有的强度来确定阈值[21]  文献[27]描述了一种用小波分析的方法发现特征峰

2.将切片数据提取值XIC，每一组数据覆盖一个m/z区域,然后可以用二阶高斯滤波器在时域中处理找到拐点[29]或者基于色谱图的均值或者中值来计算阈值[22]

3.这种方法针对同位素：将同位素模式的三维模型拟合到原始信号，不断重复减去最高峰，直至剩余峰值接近背景水平[30]，[31]使用二维模型拟合

4.有人提出直接通过对原始数据比较，跳过特征检测步骤，文献[32]直接比较了数据点，[33]比较二维GCMS

5.**[34]提出了另外一种方法：寻找符合以下3个条件的数据点：：（1）峰值必须高于阈值，（2）相邻峰值在附近光谱中也必须具有高强度，以及（3）峰值同位素范围内必须有另一峰。** [35]提出了用一种统计的方法比较两幅图的差异？？

在完成特征检测之后用特征匹配完成离子特征检测，多数粒子可能会不同的碎片，Deconvolution方法可以分配不同的离子给相同的代谢物[37-39]，2.3最后一段详解了这个方法的原理和缺陷

#### Alignment 

代谢物在不同样本之间的保留时间不同，需要使用Alignment来校正保留时间并组合来自不同样本的数据，大致有一下两种方法：

1.使用原始数据作为输入材料并生成将每次运行的保留时间轴变换为公共保留时间轴的映射集（图5a和b）的方法，

2.聚类检测到的特征并产生矩阵的方法，其中每行对应于一个簇（即离子），并且列包含每个样品的一些测量（例如峰面积）（图5c）。

3.需要注意的是：[40]cow方法，warping 方法[26,41-43]，FFT[44]，文献[45]有对这3中方法的比较

4.以上算法都是将每一列分开看，[34,46]提出了整体的观点*能不能用相似性的方法来分析两个样本？感觉有一部分可以用在这个上边*

5.还有很多不想看啦，A simple approach for aligning detected features is clustering of chromatographic peaks without correction of retention time [49].这段开始

#### Normalization

归一化的目标是消除测量之间离子强度的不必要的系统偏差，同时保留感兴趣的的生物变化。

1.统计模型：基于完整数据集[52]为每个样本推导出最优比例因子，如单位范数[53]或强度中值[23]的归一化，或最大似然法[2]。缺点：统计学方法缺乏不同代谢物的绝对浓度参考

2.基于经验规则：例如保留时间的特定区域，通过单个或多个内部（即在提取前添加到样品中）或外部（即，萃取后添加到样品中）标准化

### Software tools for data processing

介绍了一些收费/免费的工具刻用于代谢组学数据分析

***
***

## 基于1HNMR给药赭石后大鼠尿液的代谢组学分析

时间 | 期刊 | 作者 | 机构
-|-|-|-
2016/6 | 分析化学研究报告 | 魏莹&李晓晶|长春应化所

**核磁共振; 代谢组学; 主成分分析; 偏最小二乘判别分析; 赭石;**

[文献地址](http://xueshu.baidu.com/s?wd=+%E5%9F%BA%E4%BA%8E1HNMR%E7%BB%99%E8%8D%AF%E8%B5%AD%E7%9F%B3%E5%90%8E%E5%A4%A7%E9%BC%A0%E5%B0%BF%E6%B6%B2%E7%9A%84%E4%BB%A3%E8%B0%A2%E7%BB%84%E5%AD%A6%E5%88%86%E6%9E%90&tn=SE_baiduxueshu_c1gjeupa&cl=3&ie=utf-8&bs=journaluri%3A%28dff5e349c2cf161b%29+%E3%80%8AJournal+of+Chromatography+A%E3%80%8B&f=8&rsv_bp=1&rsv_sug2=1&sc_f_para=sc_tasktype%3D%7BfirstSimpleSearch%7D)

研究赭石对大鼠的影响，这篇主要熟悉一遍分析方法:分了一组对照组，3组实验组，实验组给不同浓度的赭石溶液

收集大鼠的尿液，做核磁共振，得到NMR谱图之后做归属，对得到的数据先按照不同的时间做PCA，得到PCA得分图，可以观察在不同的时间不同组之间代谢物的变化趋势以及之间的关系(PCA效果不是很好)

用PLS-DA来寻找对对照组和实验组分类贡献最大的代谢物：得分图和载荷图、排列验证

筛选特征代谢物：PLS-DA载荷图中VIP大于1的挑选出来：结合不同的时间进行分析

*这篇文章做的方法都比较常规，PCA的效果也不是很好，胜在作者的生物知识比较好，可以对药物机理的作用做出一定解释*
***